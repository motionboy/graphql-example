{"version":3,"sources":["../src/app.js"],"names":["require","app","use","endpointURL","GRAPHQL_PATH","subscriptionsEndpoint","PORT","SUBSCRIPTIONS_PATH","static","path","join","__dirname","schema","typeDefs","resolvers","context","user","req","graphQLServer","listen","err","console","log","execute","subscribe","server"],"mappings":";;AAEA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAdAA,QAAQ,qBAAR;AACAA,QAAQ,gBAAR;;AAcA,IAAMC,MAAM,wBAAZ;AACAA,IAAIC,GAAJ,CAAQ,4BAAR;AACA,2BAAYD,GAAZ;;AAEAA,IAAIC,GAAJ,CACE,WADF,EAEE,0CAAgB;AACdC,eAAa,oBAAUC,YADT;AAEdC,+CAA2C,oBAAUC,IAArD,GACE,oBAAUC;AAHE,CAAhB,CAFF;AASA;AACAN,IAAIC,GAAJ,CAAQ,kBAAQM,MAAR,CAAeC,KAAKC,IAAL,CAAUC,SAAV,EAAqB,WAArB,CAAf,CAAR;;AAEA,IAAMC,SAAS,wCAAqB;AAClCC,4BADkC;AAElCC;AAFkC,CAArB,CAAf;;AAKAb,IAAIC,GAAJ,CACE,oBAAUE,YADZ,EAEE,yCAAe;AAAA,SAAQ;AACrBQ,kBADqB;AAErBG,aAAS;AACPC,YAAMC,IAAID;AADH;AAFY,GAAR;AAAA,CAAf,CAFF;;AAUA,IAAME,gBAAgB,wBAAajB,GAAb,CAAtB;AACA;AACAiB,cAAcC,MAAd,CAAqB,oBAAUb,IAA/B,EAAqC,eAAO;AACxC,MAAIc,GAAJ,EAAS;AACLC,YAAQC,GAAR,CAAYF,GAAZ;AACH,GAFD,MAEO;AACH;AACA,qDAAuB;AACnBR,oBADmB;AAEnBW,+BAFmB;AAGnBC;AAHmB,KAAvB,EAIG;AACCC,cAAQP,aADT;AAECT,YAAM,oBAAUF;AAFjB,KAJH;AAQAc,YAAQC,GAAR,wBAAiC,oBAAUhB,IAA3C;AACH;AACJ,CAfD;AAgBA","file":"app.js","sourcesContent":["require(\"babel-core/register\");\r\nrequire(\"babel-polyfill\");\r\nimport compression from \"compression\";\r\nimport express from 'express';\r\nimport { createServer } from 'http';\r\nimport { graphqlExpress, graphiqlExpress } from \"apollo-server-express\";\r\nimport { makeExecutableSchema } from 'graphql-tools';\r\nimport { SubscriptionServer } from 'subscriptions-transport-ws';\r\nimport { execute, subscribe } from 'graphql';\r\n \r\nimport './config/db';\r\nimport typeDefs from \"./graphql/schema\";\r\nimport resolvers from \"./graphql/resolvers\";\r\nimport constants from './config/constants';\r\nimport middlewares from './config/middlewares';\r\nconst app = express();\r\napp.use(compression());\r\nmiddlewares(app);\r\n\r\napp.use(\r\n  \"/graphiql\",\r\n  graphiqlExpress({\r\n    endpointURL: constants.GRAPHQL_PATH,\r\n    subscriptionsEndpoint: `ws://35.204.1.76:${constants.PORT}${\r\n      constants.SUBSCRIPTIONS_PATH\r\n    }`\r\n  })\r\n);\r\n//Rendering the static files\r\napp.use(express.static(path.join(__dirname, \"../public\")));\r\n\r\nconst schema = makeExecutableSchema({\r\n  typeDefs,\r\n  resolvers\r\n});\r\n\r\napp.use(\r\n  constants.GRAPHQL_PATH,\r\n  graphqlExpress(req => ({\r\n    schema,\r\n    context: {\r\n      user: req.user\r\n    }\r\n  }))\r\n);\r\n\r\nconst graphQLServer = createServer(app);\r\n//mocks().then(() => {\r\ngraphQLServer.listen(constants.PORT, err => {\r\n    if (err) {\r\n        console.log(err)\r\n    } else {\r\n        //Creating subscription server\r\n        new SubscriptionServer({\r\n            schema,\r\n            execute,\r\n            subscribe\r\n        }, {\r\n            server: graphQLServer,\r\n            path: constants.SUBSCRIPTIONS_PATH\r\n        })\r\n        console.log(`Server running on ${constants.PORT}`)\r\n    }\r\n});\r\n//});"]}