<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="theme-color" content="#7740d7">
	<title>Reset Password &bull; sumaryz</title>
	<link rel="stylesheet" href="../assets/css/custom-css.css">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i|Nunito:300,400,700,900" rel="stylesheet"> 
    <link rel="shortcut icon" href="../favicon.png">
    <style type="text/css">
    	[class*="col-"]{
    		position: relative;
    	}

    	.overlay {
    		position: absolute;
    		height: 100%;
    		width: 100px;
    		right: 0;
    		top: 0;
    	}

    	@media screen and (max-width: 767px){
    		.overlay{
    			left: 0;
    			bottom: 100%;
    			/*transform: rotate(90deg) translate(0,0);*/
    			transform: rotate(90deg) translate(285%,-3.25%) scaleY(1.1);
    			transform-origin: 100% 80%;
    			width: 60px;
    			height: 100vw;
    		}
    	}
    </style>
</head>
<body>

	<section class="bg-primary container-fluid">
        <div class="row" style="min-height:100vh">
        	<div class="col-12 col-sm-6 py-5">
        		<img src="../assets/icons/logo.svg" alt="sumaryz logo" height="80" class="d-block mx-auto mb-4">
        		<img src="../assets/icons/hero-layered.svg" alt="sumaryz hero illustration" class="d-block mx-auto w-50">
        		<!-- Translucent Over-n-Under-Lay -->
	            <svg preserveAspectRatio="none" class="overlay text-white">
	                <use xlink:href="../assets/icons/symbol-defs.svg#overlay-rotated" fill="rgba(255,255,255,.5)"></use>
	            </svg>
        	</div>
        	<div class="col-12 col-sm-6 bg-white p-5">
        		<p class="font-weight-bolder h4 text-center text-dark-gray my-5 pt-5">Create Another Password</p>
        		<form id="cForm" class="px-lg-5">
                    <label class="form-group mx-sm-5">
                        <span class="form-group__label">New Password</span>
                        <input name="pass1" type="password" maxlength="16" class="form-control" required>
                    </label>
                    <label class="form-group mx-sm-5">
                        <span class="form-group__label">Verify Password</span>
                        <input type="password" name="pass2" maxlength="16" class="form-control" required>
                    </label>
                    <div class="py-3 text-center">
						<p class="alert alert-warning status" style="display:none"></p>
                        <button type="button" id="cBtn" class="btn btn-danger btn-lg px-4">Change</button>
                    </div>
                </form>
        	</div>	
        </div>
    </section>

    <script>
        (function () {
            var els = document.querySelectorAll('.form-control');
            function onInput(ev) {
                ev.target.parentNode.classList.toggle('form-group__focused')
            }
            [].slice.call(els).forEach(function (inputEl) {
                inputEl.addEventListener('focus', onInput);
                inputEl.addEventListener('blur', onInput);
            })
        })();
    </script>
	<script src="../js/ajaxModule.js"></script>
	<script type="text/javascript">
		//Student login
		_('#cBtn').addEventListener('click', function() {
			if (navigator.onLine) {
				var hr = ajaxObj('POST', '../requests/password.php');
				var formdata = new FormData(_('#cForm'));
				hr.withCredentials = true;
				hr.onreadystatechange = function() {
					if (ajaxReturn(hr) == true) {
						console.log(hr.responseText);
						var d = JSON.parse(hr.responseText);
						_("#cBtn").removeAttribute("disabled", "false");
						_("#cBtn").innerHTML = 'Login';
						_(".status").style.display = "block";
						if (d.s) {
							window.location = './dashboard';
						} else{
							_('.status').innerHTML = d.f;
						}
					}
				}
				hr.send(formdata);
				_("#cBtn").setAttribute("disabled", "true");
				_("#cBtn").innerHTML = 'Changin password..';
			} else {
				_(".status").style.display = "block";
				_('.status').innerHTML = 'No internet connection available';
				return false;
			}
		});
	</script>
</body>
</html>